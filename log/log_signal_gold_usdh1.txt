2025-06-11 18:43:24,110 - INFO - ✅ GOLD_USD-H1 シグナルランナーが初期化されました。
2025-06-11 18:43:35,155 - INFO - GOLD_USD-H1 シグナル監視ループを開始します。
2025-06-11 18:43:35,156 - INFO - GOLD_USD: MT5クライアントを初期化しています...
2025-06-11 18:43:35,156 - INFO - ✅ GOLD_USD: MT5クライアントの初期化に成功しました。
2025-06-11 18:43:35,157 - INFO - GOLD_USD: 新しい足 (H1) が形成されました。データ取得とシグナル判定を実行します。
2025-06-11 18:43:35,157 - ERROR - GOLD_USD: シグナル監視ループで予期せぬエラーが発生しました: module 'MetaTrader5' has no attribute 'is_connected'
Traceback (most recent call last):
  File "c:\Users\pc\OneDrive\Desktop\phantom_alert_bot\signal_runner_loop.py", line 190, in _run
    df, latest_time_tokyo = self._get_current_ohlc()
                            ~~~~~~~~~~~~~~~~~~~~~~^^
  File "c:\Users\pc\OneDrive\Desktop\phantom_alert_bot\signal_runner_loop.py", line 85, in _get_current_ohlc
    if not self._initialize_mt5():
           ~~~~~~~~~~~~~~~~~~~~^^
  File "c:\Users\pc\OneDrive\Desktop\phantom_alert_bot\signal_runner_loop.py", line 65, in _initialize_mt5
    if not self.mt5_initialized or not mt5.is_connected():
                                       ^^^^^^^^^^^^^^^^
AttributeError: module 'MetaTrader5' has no attribute 'is_connected'
2025-06-11 18:54:29,460 - INFO - ✅ GOLD_USD-H1 シグナルランナーが初期化されました。
2025-06-11 18:54:40,506 - INFO - GOLD_USD-H1 シグナル監視ループを開始します。
2025-06-11 18:54:40,507 - INFO - GOLD_USD: MT5クライアントを初期化しています...
2025-06-11 18:54:40,509 - INFO - ✅ GOLD_USD: MT5クライアントの初期化に成功しました。
2025-06-11 18:54:40,509 - INFO - GOLD_USD: 新しい足 (H1) が形成されました。データ取得とシグナル判定を実行します。
2025-06-11 18:54:40,546 - ERROR - GOLD_USD: シグナル監視ループで予期せぬエラーが発生しました: generate_signal() got an unexpected keyword argument 'logic'
Traceback (most recent call last):
  File "c:\Users\pc\OneDrive\Desktop\phantom_alert_bot\signal_runner_loop.py", line 177, in _run
    signal_info = generate_signal(df, mode="realtime", logic=DEFAULT_LOGIC) # modeとlogicを渡す
TypeError: generate_signal() got an unexpected keyword argument 'logic'
2025-06-12 00:09:30,886 - INFO - ✅ GOLD_USD-H1 シグナルランナーが初期化されました。
2025-06-12 00:09:41,988 - INFO - GOLD_USD-H1 シグナル監視ループを開始します。
2025-06-12 00:09:41,990 - INFO - GOLD_USD: MT5クライアントを初期化しています...
2025-06-12 00:09:41,992 - INFO - ✅ GOLD_USD: MT5クライアントの初期化に成功しました。
2025-06-12 00:09:41,992 - INFO - GOLD_USD: 新しい足 (H1) が形成されました。データ取得とシグナル判定を実行します。
2025-06-12 00:09:42,027 - INFO - GOLD_USD-H1 シグナル判定結果: Balanced Sell Signal (Confluence: MACD Dead Cross, Stochastic Dead Cross)
2025-06-12 00:09:42,027 - ERROR - GOLD_USD: シグナル監視ループで予期せぬエラーが発生しました: 'SignalRunner' object has no attribute '_generate_chart_and_upload'
Traceback (most recent call last):
  File "c:\Users\pc\OneDrive\Desktop\phantom_alert_bot\signal_runner_loop.py", line 199, in _run
    uploaded_image_url = self._generate_chart_and_upload(df, signal_info, image_filename)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'SignalRunner' object has no attribute '_generate_chart_and_upload'
2025-06-12 00:10:15,487 - INFO - ✅ GOLD_USD-H1 シグナルランナーが初期化されました。
2025-06-12 00:10:26,524 - INFO - GOLD_USD-H1 シグナル監視ループを開始します。
2025-06-12 00:10:26,524 - INFO - GOLD_USD: MT5クライアントを初期化しています...
2025-06-12 00:10:26,525 - INFO - ✅ GOLD_USD: MT5クライアントの初期化に成功しました。
2025-06-12 00:10:26,525 - INFO - GOLD_USD: 新しい足 (H1) が形成されました。データ取得とシグナル判定を実行します。
2025-06-12 00:10:26,547 - INFO - GOLD_USD-H1 シグナル判定結果: Balanced Sell Signal (Confluence: MACD Dead Cross, Stochastic Dead Cross)
2025-06-12 00:10:26,547 - ERROR - GOLD_USD: シグナル監視ループで予期せぬエラーが発生しました: 'SignalRunner' object has no attribute '_generate_chart_and_upload'
Traceback (most recent call last):
  File "C:\Users\pc\OneDrive\Desktop\phantom_alert_bot\signal_runner_loop.py", line 199, in _run
    uploaded_image_url = self._generate_chart_and_upload(df, signal_info, image_filename)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'SignalRunner' object has no attribute '_generate_chart_and_upload'
2025-06-12 00:11:00,897 - INFO - ✅ GOLD_USD-H1 シグナルランナーが初期化されました。
2025-06-12 00:11:02,793 - INFO - ✅ GOLD_USD-H1 シグナルランナーが初期化されました。
2025-06-12 00:11:11,924 - INFO - GOLD_USD-H1 シグナル監視ループを開始します。
2025-06-12 00:11:11,925 - INFO - GOLD_USD: MT5クライアントを初期化しています...
2025-06-12 00:11:11,925 - INFO - ✅ GOLD_USD: MT5クライアントの初期化に成功しました。
2025-06-12 00:11:11,925 - INFO - GOLD_USD: 新しい足 (H1) が形成されました。データ取得とシグナル判定を実行します。
2025-06-12 00:11:11,948 - INFO - GOLD_USD-H1 シグナル判定結果: Balanced Sell Signal (Confluence: MACD Dead Cross, Stochastic Dead Cross)
2025-06-12 00:11:11,948 - ERROR - GOLD_USD: シグナル監視ループで予期せぬエラーが発生しました: 'SignalRunner' object has no attribute '_generate_chart_and_upload'
Traceback (most recent call last):
  File "C:\Users\pc\OneDrive\Desktop\phantom_alert_bot\signal_runner_loop.py", line 199, in _run
    uploaded_image_url = self._generate_chart_and_upload(df, signal_info, image_filename)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'SignalRunner' object has no attribute '_generate_chart_and_upload'
2025-06-12 00:11:13,826 - INFO - GOLD_USD-H1 シグナル監視ループを開始します。
2025-06-12 00:11:13,828 - INFO - GOLD_USD: MT5クライアントを初期化しています...
2025-06-12 00:11:13,830 - INFO - ✅ GOLD_USD: MT5クライアントの初期化に成功しました。
2025-06-12 00:11:13,830 - INFO - GOLD_USD: 新しい足 (H1) が形成されました。データ取得とシグナル判定を実行します。
2025-06-12 00:11:13,868 - INFO - GOLD_USD-H1 シグナル判定結果: Balanced Sell Signal (Confluence: MACD Dead Cross, Stochastic Dead Cross)
2025-06-12 00:11:13,868 - ERROR - GOLD_USD: シグナル監視ループで予期せぬエラーが発生しました: 'SignalRunner' object has no attribute '_generate_chart_and_upload'
Traceback (most recent call last):
  File "C:\Users\pc\OneDrive\Desktop\phantom_alert_bot\signal_runner_loop.py", line 199, in _run
    uploaded_image_url = self._generate_chart_and_upload(df, signal_info, image_filename)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'SignalRunner' object has no attribute '_generate_chart_and_upload'
2025-06-12 00:21:42,028 - INFO - GOLD_USD: 新しい足 (H1) が形成されました。データ取得とシグナル判定を実行します。
2025-06-12 00:21:42,083 - INFO - GOLD_USD-H1 シグナル判定結果: Balanced Sell Signal (Confluence: MACD Dead Cross, Stochastic Dead Cross)
2025-06-12 00:21:42,084 - ERROR - GOLD_USD: シグナル監視ループで予期せぬエラーが発生しました: 'SignalRunner' object has no attribute '_generate_chart_and_upload'
Traceback (most recent call last):
  File "c:\Users\pc\OneDrive\Desktop\phantom_alert_bot\signal_runner_loop.py", line 199, in _run
    # シグナルが出た場合、LINE通知とチャート画像生成・アップロード
                      ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'SignalRunner' object has no attribute '_generate_chart_and_upload'
2025-06-12 00:23:11,950 - INFO - GOLD_USD: 新しい足 (H1) が形成されました。データ取得とシグナル判定を実行します。
2025-06-12 00:23:11,997 - INFO - GOLD_USD-H1 シグナル判定結果: Balanced Sell Signal (Confluence: MACD Dead Cross, Stochastic Dead Cross)
2025-06-12 00:23:11,998 - ERROR - GOLD_USD: シグナル監視ループで予期せぬエラーが発生しました: 'SignalRunner' object has no attribute '_generate_chart_and_upload'
Traceback (most recent call last):
  File "C:\Users\pc\OneDrive\Desktop\phantom_alert_bot\signal_runner_loop.py", line 199, in _run
    # シグナルが出た場合、LINE通知とチャート画像生成・アップロード
                      ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'SignalRunner' object has no attribute '_generate_chart_and_upload'
2025-06-12 00:23:13,871 - INFO - GOLD_USD: 新しい足 (H1) が形成されました。データ取得とシグナル判定を実行します。
2025-06-12 00:23:13,893 - INFO - GOLD_USD-H1 シグナル判定結果: Balanced Sell Signal (Confluence: MACD Dead Cross, Stochastic Dead Cross)
2025-06-12 00:23:13,894 - ERROR - GOLD_USD: シグナル監視ループで予期せぬエラーが発生しました: 'SignalRunner' object has no attribute '_generate_chart_and_upload'
Traceback (most recent call last):
  File "C:\Users\pc\OneDrive\Desktop\phantom_alert_bot\signal_runner_loop.py", line 199, in _run
    # シグナルが出た場合、LINE通知とチャート画像生成・アップロード
                      ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'SignalRunner' object has no attribute '_generate_chart_and_upload'
2025-06-12 00:33:42,087 - INFO - GOLD_USD: 新しい足 (H1) が形成されました。データ取得とシグナル判定を実行します。
2025-06-12 00:33:42,152 - INFO - GOLD_USD-H1 シグナル判定結果: Balanced Sell Signal (Confluence: MACD Dead Cross, Stochastic Dead Cross)
2025-06-12 00:33:42,153 - ERROR - GOLD_USD: シグナル監視ループで予期せぬエラーが発生しました: 'SignalRunner' object has no attribute '_generate_chart_and_upload'
Traceback (most recent call last):
  File "c:\Users\pc\OneDrive\Desktop\phantom_alert_bot\signal_runner_loop.py", line 199, in _run
    # シグナルが出た場合、LINE通知とチャート画像生成・アップロード
                      ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'SignalRunner' object has no attribute '_generate_chart_and_upload'
2025-06-12 00:35:11,999 - INFO - GOLD_USD: 新しい足 (H1) が形成されました。データ取得とシグナル判定を実行します。
2025-06-12 00:35:12,021 - INFO - GOLD_USD-H1 シグナル判定結果: Balanced Sell Signal (Confluence: MACD Dead Cross, Stochastic Dead Cross)
2025-06-12 00:35:12,022 - ERROR - GOLD_USD: シグナル監視ループで予期せぬエラーが発生しました: 'SignalRunner' object has no attribute '_generate_chart_and_upload'
Traceback (most recent call last):
  File "C:\Users\pc\OneDrive\Desktop\phantom_alert_bot\signal_runner_loop.py", line 199, in _run
    # シグナルが出た場合、LINE通知とチャート画像生成・アップロード
                      ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'SignalRunner' object has no attribute '_generate_chart_and_upload'
2025-06-12 00:35:13,896 - INFO - GOLD_USD: 新しい足 (H1) が形成されました。データ取得とシグナル判定を実行します。
2025-06-12 00:35:13,925 - INFO - GOLD_USD-H1 シグナル判定結果: Balanced Sell Signal (Confluence: MACD Dead Cross, Stochastic Dead Cross)
2025-06-12 00:35:13,925 - ERROR - GOLD_USD: シグナル監視ループで予期せぬエラーが発生しました: 'SignalRunner' object has no attribute '_generate_chart_and_upload'
Traceback (most recent call last):
  File "C:\Users\pc\OneDrive\Desktop\phantom_alert_bot\signal_runner_loop.py", line 199, in _run
    # シグナルが出た場合、LINE通知とチャート画像生成・アップロード
                      ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'SignalRunner' object has no attribute '_generate_chart_and_upload'
2025-06-12 00:45:42,155 - INFO - GOLD_USD: 新しい足 (H1) が形成されました。データ取得とシグナル判定を実行します。
2025-06-12 00:45:42,192 - INFO - GOLD_USD-H1 シグナル判定結果: Balanced Sell Signal (Confluence: MACD Dead Cross, Stochastic Dead Cross)
2025-06-12 00:45:42,192 - ERROR - GOLD_USD: シグナル監視ループで予期せぬエラーが発生しました: 'SignalRunner' object has no attribute '_generate_chart_and_upload'
Traceback (most recent call last):
  File "c:\Users\pc\OneDrive\Desktop\phantom_alert_bot\signal_runner_loop.py", line 199, in _run
    # シグナルが出た場合、LINE通知とチャート画像生成・アップロード
                      ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'SignalRunner' object has no attribute '_generate_chart_and_upload'
2025-06-12 00:47:12,024 - INFO - GOLD_USD: 新しい足 (H1) が形成されました。データ取得とシグナル判定を実行します。
2025-06-12 00:47:12,060 - INFO - GOLD_USD-H1 シグナル判定結果: No signal
2025-06-12 00:47:12,061 - INFO - GOLD_USD-H1: シグナルなし。
2025-06-12 00:47:12,061 - ERROR - GOLD_USD: シグナル監視ループで予期せぬエラーが発生しました: cannot access local variable 'uploaded_image_url' where it is not associated with a value
Traceback (most recent call last):
  File "C:\Users\pc\OneDrive\Desktop\phantom_alert_bot\signal_runner_loop.py", line 230, in _run
UnboundLocalError: cannot access local variable 'uploaded_image_url' where it is not associated with a value
2025-06-12 00:47:13,929 - INFO - GOLD_USD: 新しい足 (H1) が形成されました。データ取得とシグナル判定を実行します。
2025-06-12 00:47:13,984 - INFO - GOLD_USD-H1 シグナル判定結果: No signal
2025-06-12 00:47:13,984 - INFO - GOLD_USD-H1: シグナルなし。
2025-06-12 00:47:13,985 - ERROR - GOLD_USD: シグナル監視ループで予期せぬエラーが発生しました: cannot access local variable 'uploaded_image_url' where it is not associated with a value
Traceback (most recent call last):
  File "C:\Users\pc\OneDrive\Desktop\phantom_alert_bot\signal_runner_loop.py", line 230, in _run
UnboundLocalError: cannot access local variable 'uploaded_image_url' where it is not associated with a value
2025-06-12 10:40:26,306 - INFO - ✅ GOLD_USD-H1 シグナルランナーが初期化されました。
2025-06-12 10:40:37,368 - INFO - GOLD_USD-H1 シグナル監視ループを開始します。
2025-06-12 10:40:37,370 - INFO - GOLD_USD: MT5クライアントを初期化しています...
2025-06-12 10:40:37,371 - INFO - ✅ GOLD_USD: MT5クライアントの初期化に成功しました。
2025-06-12 10:40:37,372 - INFO - GOLD_USD: 新しい足 (H1) が形成されました。データ取得とシグナル判定を実行します。
2025-06-12 10:40:37,425 - ERROR - GOLD_USD: シグナル監視ループで予期せぬエラーが発生しました: 'MACD_Signal'
Traceback (most recent call last):
  File "C:\Users\pc\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'MACD_Signal'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\Users\pc\OneDrive\Desktop\phantom_alert_bot\signal_runner_loop.py", line 196, in _run
    signal_info = generate_signal(df, mode="realtime", logic=DEFAULT_LOGIC) # modeとlogicを渡す
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\pc\OneDrive\Desktop\phantom_alert_bot\signal_generator.py", line 71, in generate_signal
    signal_info = _generate_balanced_signal(df_ind, current_price)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\pc\OneDrive\Desktop\phantom_alert_bot\signal_generator.py", line 192, in _generate_balanced_signal
    macd_buy = (df_ind['MACD'].iloc[-1] > df_ind['MACD_Signal'].iloc[-1]) # MACDゴールデンクロス
                                          ~~~~~~^^^^^^^^^^^^^^^
  File "C:\Users\pc\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\frame.py", line 4107, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pc\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\indexes\base.py", line 3819, in get_loc
    raise KeyError(key) from err
KeyError: 'MACD_Signal'
2025-06-13 01:18:32,299 - INFO - ✅ GOLD_USD-H1 シグナルランナーが初期化されました。
2025-06-13 01:18:43,340 - INFO - GOLD_USD-H1 シグナル監視ループを開始します。
2025-06-13 01:18:43,343 - INFO - GOLD_USD: MT5クライアントを初期化しています...
2025-06-13 01:18:43,348 - INFO - ✅ GOLD_USD: MT5クライアントの初期化に成功しました。
2025-06-13 01:18:43,350 - INFO - GOLD_USD: 新しい足 (H1) が形成されました。データ取得とシグナル判定を実行します。
2025-06-13 01:18:43,365 - ERROR - GOLD_USD: シグナル監視ループで予期せぬエラーが発生しました: Cannot convert tz-naive timestamps, use tz_localize to localize
Traceback (most recent call last):
  File "C:\Users\pc\OneDrive\Desktop\phantom_alert_bot\signal_runner_loop.py", line 192, in _run
    df, latest_time_tokyo = self._get_current_ohlc()
                            ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pc\OneDrive\Desktop\phantom_alert_bot\signal_runner_loop.py", line 116, in _get_current_ohlc
    df.index = df.index.tz_convert('Asia/Tokyo') # チャート描画時などのため
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pc\OneDrive\Desktop\phantom_alert_bot\venv\Lib\site-packages\pandas\core\indexes\datetimes.py", line 283, in tz_convert
    arr = self._data.tz_convert(tz)
          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pc\OneDrive\Desktop\phantom_alert_bot\venv\Lib\site-packages\pandas\core\arrays\datetimes.py", line 917, in tz_convert
    raise TypeError(
TypeError: Cannot convert tz-naive timestamps, use tz_localize to localize
